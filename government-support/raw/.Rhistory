# set working directory
setwd("~/Desktop/arts-vibrancy-index/government-support/raw")
# load packages
library(tidyr)
library(plyr)
# import and merge state funding data
state <- lapply(Sys.glob("NASAA_*.csv"), read.csv)
state <- do.call(rbind.data.frame, state)
# remove grantor and rename columns
state <- state[,-5]
state <- rename(state, c("Zip.Code"="zip","Fiscal.Year"="year","No..of.Awards"="awards","Grant.Dollars"="dollars"))
# convert dollars to numeric and remove dollar and commas
state$dollars <- as.numeric(gsub("[\\$,]", "", state$dollars))
# sum awards and dollars by year for each zip code
library(dplyr)
state <- state %>%
select(zip, year, awards, dollars) %>%
group_by(zip, year) %>%
summarise(awards = sum(awards), dollars = sum(dollars))
View(state)
# import NEA and IMLS data
IMLS <- read.csv("IMLS_Awarded_Grants_Search_NY_03-13-2019.csv")
NEA <- read.csv("NEAgrantsearch_1998-2019_30mi_10016.csv")
# remove unnecessary columns from NEA and IMLS data sets
IMLS <- IMLS[,c(4,7,8)]
NEA <- NEA[,c(8,10,12)]
IMLS <- rename(IMLS, c("zip_added"="zip","Fiscal.Year"="year","Award"="dollars"))
# rename columns (must detach dplyr package first)
detach(dplyr)
# rename columns (must detach dplyr package first)
detach("dplyr")
# rename columns (must detach dplyr package first)
detach(dplyr)
detach("package:dplyr", unload=TRUE)
IMLS <- rename(IMLS, c("zip_added"="zip","Fiscal.Year"="year","Award"="dollars"))
IMLS <- rename(IMLS, c("zip_added"="zip","Fiscal.Year"="year","Award"="dollars"))
NEA <- rename(NEA, c("Zip"="zip","Fiscal.Year"="year","Grant.Amount"="dollars"))
# convert dollars to numeric and remove dollar and commas
IMLS$dollars <- as.numeric(gsub("[\\$,]", "", IMLS$dollars))
# import NEA and IMLS data
IMLS <- read.csv("IMLS_Awarded_Grants_Search_NY_03-13-2019.csv")
# remove unnecessary columns from NEA and IMLS data sets
IMLS <- IMLS[,c(4,7,8)]
IMLS <- rename(IMLS, c("zip_added"="zip","Fiscal.Year"="year","Award"="dollars"))
# convert dollars to numeric and remove dollar and commas
IMLS$dollars <- as.numeric(gsub("[\\$,]", "", IMLS$dollars))
str(IMLS)
# import NEA and IMLS data
IMLS <- read.csv("IMLS_Awarded_Grants_Search_NY_03-13-2019.csv")
# remove unnecessary columns from NEA and IMLS data sets
IMLS <- IMLS[,c(4,7,8)]
IMLS <- rename(IMLS, c("zip_added"="zip","Fiscal.Year"="year","Award"="dollars"))
# convert dollars to numeric and remove dollar and commas
IMLS$dollars <- as.numeric(gsub("[\\$,]", "", IMLS$dollars))
str(IMLS)
str(NEA)
NEA$dollars <- as.numeric(gsub("[\\$,]", "", NEA$dollars))
str(NEA)
# convert NEA zips to 5 digit
a <-(NEA$zip, 5)
# convert NEA zips to 5 digit
a <-(NEA$zip, 5)
# convert NEA zips to 5 digit
a <-(as.character(NEA$zip), 5)
# convert NEA zips to 5 digit
a <-as.character(NEA$zip)
# convert NEA zips to 5 digit
zip <-as.character(NEA$zip)
zip <- strtrim(zip, 5)
# convert NEA zips to 5 digit
zip <-as.character(NEA$zip)
zip <- strtrim(zip, 5)
a <- strtrim(as.character(NEA$zip), 5)
str(NEA)
# import NEA and IMLS data
IMLS <- read.csv("IMLS_Awarded_Grants_Search_NY_03-13-2019.csv")
# remove unnecessary columns from NEA and IMLS data sets
IMLS <- IMLS[,c(4,7,8)]
IMLS <- rename(IMLS, c("zip_added"="zip","Fiscal.Year"="year","Award"="dollars"))
NEA <- read.csv("NEAgrantsearch_1998-2019_30mi_10016.csv")
NEA <- NEA[,c(8,10,12)]
NEA <- rename(NEA, c("Zip"="zip","Fiscal.Year"="year","Grant.Amount"="dollars"))
# convert dollars to numeric and remove dollar and commas
IMLS$dollars <- as.numeric(gsub("[\\$,]", "", IMLS$dollars))
NEA$dollars <- as.numeric(gsub("[\\$,]", "", NEA$dollars))
str(NEA)
str(IMLS)
# convert NEA zips to 5 digit
NEA$zip <- strtrim(as.character(NEA$zip), 5)
str(NEA)
NEA$zip <- as.integer(NEA$zip)
str(NEA)
str(IMLS)
# merge IMLS and NEA data into single file
df <- rbind(NEA,IMLS)
466+8577
# merge IMLS and NEA data into single file
federal <- rbind(NEA,IMLS)
rm(df)
rm(zip)
rm(a)
View(federal)
# sum awards and dollars by year for each zip code
library(dplyr)
a <- federal %>%
select(zip, year, dollars) %>%
group_by(zip, year) %>%
summarise(awards = length(dollars), dollars = sum(dollars))
View(a)
federal <- federal %>%
select(zip, year, dollars) %>%
group_by(zip, year) %>%
summarise(awards = length(dollars), dollars = sum(dollars))
rm(a)
is.na(federal)
length(is.na(federal))
anyNA(federal)
anyNA(state)
which(is.na(federal))
5126/1549
which(is.na(IMLS))
which(is.na(NEA))
View(IMLS)
# import NEA and IMLS data
IMLS <- read.csv("IMLS_Awarded_Grants_Search_NY_03-13-2019.csv")
# remove unnecessary columns from NEA and IMLS data sets
IMLS <- IMLS[,c(4,7,8)]
IMLS <- rename(IMLS, c("zip_added"="zip","Fiscal.Year"="year","Award"="dollars"))
# rename columns (must detach dplyr package first)
detach("package:dplyr", unload=TRUE)
IMLS <- rename(IMLS, c("zip_added"="zip","Fiscal.Year"="year","Award"="dollars"))
which(is.na(IMLS))
which(is.na(NEA))
# convert dollars to numeric and remove dollar and commas
IMLS$dollars <- as.numeric(gsub("[\\$,]", "", IMLS$dollars))
NEA$dollars <- as.numeric(gsub("[\\$,]", "", NEA$dollars))
which(is.na(NEA))
which(is.na(IMLS))
# remove rows with NAs
a <- drop_na(IMLS)
b <- drop_na(NEA)
rm(c(a,b))
rm(a)
rm(b)
# set working directory
setwd("~/Desktop/arts-vibrancy-index/government-support/raw")
# load packages
library(tidyr)
library(plyr)
# import and merge state funding data
state <- lapply(Sys.glob("NASAA_*.csv"), read.csv)
state <- do.call(rbind.data.frame, state)
# remove grantor and rename columns
state <- state[,-5]
state <- rename(state, c("Zip.Code"="zip","Fiscal.Year"="year","No..of.Awards"="awards","Grant.Dollars"="dollars"))
# convert dollars to numeric and remove dollar and commas
state$dollars <- as.numeric(gsub("[\\$,]", "", state$dollars))
# sum awards and dollars by year for each zip code
library(dplyr)
state <- state %>%
select(zip, year, awards, dollars) %>%
group_by(zip, year) %>%
summarise(awards = sum(awards), dollars = sum(dollars))
# export state data to csv
write.csv(state, file = "~/Desktop/arts-vibrancy-index/government-support/state_clean.csv", row.names = FALSE)
# import NEA and IMLS data
IMLS <- read.csv("IMLS_Awarded_Grants_Search_NY_03-13-2019.csv")
NEA <- read.csv("NEAgrantsearch_1998-2019_30mi_10016.csv")
# remove unnecessary columns from NEA and IMLS data sets
IMLS <- IMLS[,c(4,7,8)]
NEA <- NEA[,c(8,10,12)]
# rename columns (must detach dplyr package first)
detach("package:dplyr", unload=TRUE)
IMLS <- rename(IMLS, c("zip_added"="zip","Fiscal.Year"="year","Award"="dollars"))
NEA <- rename(NEA, c("Zip"="zip","Fiscal.Year"="year","Grant.Amount"="dollars"))
# convert dollars to numeric and remove dollar and commas
IMLS$dollars <- as.numeric(gsub("[\\$,]", "", IMLS$dollars))
NEA$dollars <- as.numeric(gsub("[\\$,]", "", NEA$dollars))
# remove rows with NAs
IMLS <- drop_na(IMLS)
NEA <- drop_na(NEA)
# convert NEA zips to 5 digit
NEA$zip <- strtrim(as.character(NEA$zip), 5)
NEA$zip <- as.integer(NEA$zip)
# merge IMLS and NEA data into single file
federal <- rbind(NEA,IMLS)
# sum awards and dollars by year for each zip code
library(dplyr)
federal <- federal %>%
select(zip, year, dollars) %>%
group_by(zip, year) %>%
summarise(awards = length(dollars), dollars = sum(dollars))
View(federal)
View(state)
# export federal data to csv
write.csv(federal, file = "~/Desktop/arts-vibrancy-index/government-support/federal_clean.csv", row.names = FALSE)
